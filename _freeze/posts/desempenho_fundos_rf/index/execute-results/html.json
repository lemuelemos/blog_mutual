{
  "hash": "6feefbc9148bd900bb958b8ca7915af7",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Desempenho dos Fundos de Renda Fixa\"\nauthor: \"Lemuel Lemos\"\ndate: \"2025-03-01\"\ncategories: [fundos de investimentos, desempenho, renda fixa]\nimage: \"image.jpg\"\nexecute:\n  warning: false\n  message: false\n---\n\n\n\nDesde que concluí minha tese sobre fundos de investimento, no início de 2014, venho considerando publicar posts regulares sobre o tema. O objetivo é construir uma base de conhecimento e compartilhar insights relevantes. Embora existam páginas que comparam fundos, ainda são raras as discussões que abordam a indústria de forma mais abrangente, analisando aspectos como captação, rentabilidade, risco e diversas outras métricas. Neste espaço, a proposta é analisar os dados de forma agregada, sem focar em fundos individuais.\n\nNeste primeiro post, abordaremos questões mais técnicas, como o download dos dados, tratamento, integração de bases e outros processos necessários para nossas análises. Começaremos analisando as três principais classes de fundos: renda fixa, multimercados e ações. Esta será a primeira de uma série de três publicações, cada uma dedicada a uma das classes mencionadas.\n\nVamos cobrir todas as etapas do processo, como coleta dos dados, limpeza, manipulação e armazenamento. Além do processamento dos dados, vamos criar nossas análises sobre essas informações, a fim de entender o comportamento da indústria de fundos.\n\n### Fonte de Dados\n\nVamos utilizar como base de dados primária os dados presentes na <a href=\"https://dados.cvm.gov.br/group/fundos-de-investimento\" target=\"_blank\">CVM</a>, de onde pegaremos todos os dados referentes aos dados de cotas, dados cadastrais e o que é chamado de extrato de informações. Além disso, vamos utilizar dados fornecidos pela ANBIMA. Vamos utilizar as classificações dos fundos presentes nos dados cadastrais que a instituição utiliza. A escolha de utilização da classificação ANBIMA, está no fato de que durante o processo de tratamento de dados em minha tese de doutorado, percebi algumas inconsistências na base da CVM. \n\n### Aquisição de dados\n\nOs primeiros dados que iremos baixar são aqueles referentes às cotas, ao PL e à captação dos fundos de investimento disponíveis no portal de dados abertos da <a href=\"https://dados.cvm.gov.br/group/fundos-de-investimento\" target=\"_blank\">CVM</a>. O nome da base é: <a href=\"https://dados.cvm.gov.br/dataset/fi-doc-inf_diario\" target=\"_blank\">Informe Diário</a>.\n\nA CVM nos alerta que esses dados podem ser reapresentados em até M-11, além de dividi-los em dois repositórios: um contendo dados históricos desde 2000 até 2020, e outro com dados de 2021 até os dias atuais. Vamos baixar ambos. Faremos o download de arquivos compactados, que serão descompactados e carregados em nossa base de dados. Após a descompactação, uniremos todos os arquivos em uma única base.\n\nPara lidar com o grande volume de dados, vamos paralelizar nossa execução usando o pacote `furrr`. Além disso, utilizaremos os pacotes `dplyr` e `tidyr` para realizar a manipulação dos dados em memória, enquanto o `pins` nos servirá como repositório para armazená-los. Para nosso banco de dados, adotaremos o **DuckDB**, o que nos permitirá trabalhar de forma eficiente com grandes tabelas em disco, e contaremos ainda com o pacote `dbplyr` para manipular os dados diretamente no banco.\n\nPrimeira coisa que vamos fazer é carrregar os pacotes necessários e conectar ao nosso banco. Lembro que se você for fazer isos em sua máquina o caminho que está sendo utilizando no parâmetro `dbdir` tem que ser relativo a sua própria pasta. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(dbplyr)\nlibrary(tidyr)\nlibrary(furrr)\nlibrary(reactable)\nlibrary(htmltools)\nlibrary(ggplot2)\nlibrary(scales)\nlibrary(ggimprensa)\n\n# Conectando a base de dados\n\ncon <- DBI::dbConnect(duckdb::duckdb(), \n                 dbdir = \"fundos_db.duckdb\",\n                 read_only = FALSE)\n```\n:::\n\n\n\nPara obter o conjunto completo de dados, vamos acessar os endereços [HIST](https://dados.cvm.gov.br/dados/FI/DOC/INF_DIARIO/DADOS/HIST/) e [DADOS](https://dados.cvm.gov.br/dados/FI/DOC/INF_DIARIO/DADOS/) para baixar todos os arquivos disponíveis. Para otimizar essa etapa, utilizaremos as funções de paralelização do pacote `furrr`, configurando quatro clusters para realizar as requisições simultaneamente e, assim, agilizar o processo de download.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Criando a sequência de datas para criar as urls de download\n\nanos_download <- seq(2000,2020,1)\nmeses_download <- format(seq(as.Date(\"2021-01-01\"),\n                             as.Date(\"2025-01-01\"),\n                             by = \"month\"),\n                         \"%Y%m\")\n\n# Definindo o número de workers\nfuture::plan(future::multisession, \n             workers = 6)\n\n# Fazendo donwload dos arquivos de 2000 a 2020\n\nfurrr::future_walk(anos_download, function(ano){\n  options(timeout = 600)\n  url <- paste0(\"https://dados.cvm.gov.br/dados/FI/DOC/INF_DIARIO/DADOS/HIST/inf_diario_fi_\",\n                ano,\n                \".zip\")\n  destfile <- paste0(\"./informe_diario/\",ano,\".zip\")\n  utils::download.file(url,destfile,mode = \"wb\")\n},.progress = T)\n\n\n# Fazendo donwload dos arquivos de 2021 a janeiro de 2025 \n\nfurrr::future_walk(meses_download, function(mes){\n  options(timeout = 600)\n  url <- paste0(\"https://dados.cvm.gov.br/dados/FI/DOC/INF_DIARIO/DADOS/inf_diario_fi_\",\n                mes,\n                \".zip\")\n  destfile <- paste0(\"./informe_diario/\",mes,\".zip\")\n  download.file(url,destfile)\n},\n.progress = T)\n\n# Dezipando arquivos \n\nzipfiles <- list.files(\"./informe_diario/\",full.names = T,pattern = \".zip\")\n\nfurrr::future_walk(zipfiles,function(path){\n  unzip(path,exdir = \"./informe_diario/\")\n})\n\n# Deletando arquivos baixados\n\ninvisible(file.remove(list.files(\"./posts/desempenho_fundos_rf/informe_diario/\",\n                                 full.names = T)))\n\n# Excluindo os workers da paralelização\nfuture::plan(future::sequential)\n```\n:::\n\n\n\nDepois de baixar todos os arquivos, precisamos ler cada um dos CSVs e unificá-los em um único objeto. Essa etapa pode ser bastante exigente em termos de recursos e, por isso, pode não rodar tão facilmente em alguns computadores. No meu caso, como a minha máquina tem 32 GB de memória, consegui processar tudo sem maiores problemas.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\narquivos_csv <- list.files(\"./informe_diario/\",full.names = T,pattern = \".csv\")\n\nfuture::plan(future::multisession, workers = 6)\nfurrr::future_map(arquivos_csv, function(arquivo){\n  readr::read_delim(arquivo, \n    delim = \";\", escape_double = FALSE, trim_ws = TRUE)\n},.progress = T) -> informes_diarios\n\nfuture::plan(future::sequential)\n\ninformes_diarios %>% \n  bind_rows() -> informes_diarios\n```\n:::\n\n\n\nDeletando o objeto com todos os CSVs lidos.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nDBI::dbWriteTable(con,\"informes_diarios\",informes_diarios)\nrm(informes_diarios)\n```\n:::\n\n\n### ETL dos Dados\n\nPrimeiro passo para começarmos o ETL de nossos dados consiste em conetarmos com nossa base de dados. Vamos utilizar a função do `dplyr` `tbl`. Isso nos permite lidar com a tabela que está no nosso banco do DuckDB como se fosse um DF dentro de nosso projeto. Os arquivos que baixamos possuem todos os tipos de fundos. Aqui vamos nos concentrar nos fundos de investimentos tradicionais, os conhecido por fazerem parte da instrução CVM 175. Para fazer isso vamos filtrar nossa base somente com estes fundos, onde vamos filtrar somente os fundos com a designação **FI** na base. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninformes_diarios <- tbl(con,\"informes_diarios\") \n```\n:::\n\n\n\nVamos começar integrando à base de dados fornecida pela ANBIMA. Primeiro, leremos o arquivo e o salvaremos em nossa base do DuckDB. Em seguida, faremos a união das duas fontes de dados, o que nos permitirá filtrar apenas as classes de fundos que desejamos para este primeiro momento, focando nos fundos de renda fixa.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfundos_175_anbima <- readxl::read_excel(\"fundos-175-caracteristicas-publico-22-02-2025-12-01-14.xlsx\")\nDBI::dbWriteTable(con,\"fundos_175_anbima\",fundos_175_anbima)\nrm(fundos_175_anbima)\n```\n:::\n\n\n\n**Texto revisado e sugestões de melhoria:**\n\nAqui, como os dados filtrados resultaram em uma quantidade menor, o tamanho da base nos permite trabalhar tudo dentro do R sem problemas de desempenho. O `DuckDB` é fundamental para filtrar e unir as bases, pois o tempo de execução é bastante reduzido devido à sua maior eficiência ao lidar com grandes volumes de dados. Apenas a base de FI, por exemplo, possui cerca de 20 milhões de linhas, o que deixaria a análise diretamente no R muito lenta. Ao reduzir o tamanho da base, passamos a poder trabalhar tudo dentro do próprio R, sem precisar utilizar o `DuckDB`. É isso que fazemos a seguir.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninformes_diarios %>% \n  mutate(CNPJ_FUNDO = case_when(is.na(CNPJ_FUNDO) ~ CNPJ_FUNDO_CLASSE,\n                                .default = CNPJ_FUNDO),\n         TP_FUNDO = case_when(is.na(TP_FUNDO) ~ TP_FUNDO_CLASSE,\n                              .default = TP_FUNDO)) %>% \n  mutate(CNPJ_FUNDO = sql(\"regexp_replace(CNPJ_FUNDO, '[^0-9]', '', 'g')\")) %>% \n  left_join(\n    tbl(con,\"fundos_175_anbima\") %>% \n      filter(`CNPJ do Fundo` != \"58137699000116\") %>% \n      select(`Código ANBIMA`,\n             Estrutura,\n             `CNPJ do Fundo`,\n             `Nome Comercial`,\n             Status,\n             `Categoria ANBIMA`,\n             `Tipo ANBIMA`,\n             `Composição do Fundo`,\n             `Aberto Estatutariamente`,\n              `Tributação Alvo`,\n             `Primeiro Aporte`,\n             `Tipo de Investidor`,\n             `Característica do Investidor`,\n             `Cota de Abertura`,\n             `Aplicação Inicial Mínima`,\n             `Prazo Pagamento Resgate em dias`),\n    by = c(\"CNPJ_FUNDO\" = \"CNPJ do Fundo\")\n  ) %>% \n  filter(`Categoria ANBIMA` == \"Renda Fixa\") %>% \n  collect()  -> fundos_rf\n```\n:::\n\n\n\nDepois de realizar esses processamentos, vamos conferir a quantidade de fundos com os quais trabalharemos.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(reactable)\n\nfundos_rf %>%\n  ungroup() %>%  # Remove qualquer agrupamento existente nos dados\n  distinct(CNPJ_FUNDO, `Categoria ANBIMA`, `Tipo ANBIMA`) %>%  # Mantém apenas combinações únicas dessas colunas\n  count(`Categoria ANBIMA`, `Tipo ANBIMA`) %>%  # Conta a quantidade de fundos por categoria e tipo\n  arrange(-n) %>%  # Ordena os dados de forma decrescente com base na contagem\n  rename(Quantidade = n) %>%  # Renomeia a coluna de contagem para \"Quantidade\"\n  reactable::reactable(\n    pagination = FALSE,  # Desativa a paginação da tabela\n    defaultColDef = colDef(minWidth = 120),  # Define uma largura mínima de 120 para todas as colunas\n    resizable = TRUE,  # Permite que as colunas sejam redimensionáveis\n    columns = list(\n      `Categoria ANBIMA` = colDef(width = 200),  # Define a largura da coluna \"Categoria ANBIMA\"\n      `Tipo ANBIMA`      = colDef(width = 300),  # Define a largura da coluna \"Tipo ANBIMA\"\n      Quantidade         = colDef(\n        align = \"right\",  # Alinha os valores numéricos à direita\n        format = colFormat(separators = TRUE),  # Formata os números com separadores de milhar\n        footer = function(values) {  # Define o conteúdo do rodapé da coluna\n          htmltools::tags$b(\"Total: \") %>%  # Deixa a palavra \"Total\" em negrito\n            htmltools::tagAppendChildren(htmltools::tags$span(sum(values)))  # Exibe a soma total ao lado\n        }\n      )\n    )\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"reactable html-widget html-fill-item\" id=\"htmlwidget-e7626f38e88feaa66688\" style=\"width:auto;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-e7626f38e88feaa66688\">{\"x\":{\"tag\":{\"name\":\"Reactable\",\"attribs\":{\"data\":{\"Categoria ANBIMA\":[\"Renda Fixa\",\"Renda Fixa\",\"Renda Fixa\",\"Renda Fixa\",\"Renda Fixa\",\"Renda Fixa\",\"Renda Fixa\",\"Renda Fixa\",\"Renda Fixa\",\"Renda Fixa\",\"Renda Fixa\",\"Renda Fixa\",\"Renda Fixa\",\"Renda Fixa\",\"Renda Fixa\",\"Renda Fixa\"],\"Tipo ANBIMA\":[\"Renda Fixa Duração Livre Crédito Livre\",\"Renda Fixa Duração Livre Grau de Investimento\",\"Renda Fixa Duração Baixa Grau de Investimento\",\"Renda Fixa Duração Livre Soberano\",\"Renda Fixa Duração Baixa Soberano\",\"Renda Fixa Indexados\",\"Renda Fixa Simples\",\"Renda Fixa Investimento no Exterior\",\"Renda Fixa Duração Média Grau de Investimento\",\"Renda Fixa Duração Alta Grau de Investimento\",\"Renda Fixa Duração Baixa Crédito Livre\",\"Renda Fixa Duração Média Crédito Livre\",\"Renda Fixa Duração Alta Crédito Livre\",\"Renda Fixa Duração Média Soberano\",\"Renda Fixa Duração Alta Soberano\",\"Renda Fixa Dívida Externa\"],\"Quantidade\":[2011,909,512,341,259,194,147,131,117,62,43,41,33,18,17,5]},\"columns\":[{\"id\":\"Categoria ANBIMA\",\"name\":\"Categoria ANBIMA\",\"type\":\"character\",\"minWidth\":120,\"width\":200},{\"id\":\"Tipo ANBIMA\",\"name\":\"Tipo ANBIMA\",\"type\":\"character\",\"minWidth\":120,\"width\":300},{\"id\":\"Quantidade\",\"name\":\"Quantidade\",\"type\":\"numeric\",\"minWidth\":120,\"format\":{\"cell\":{\"separators\":true},\"aggregated\":{\"separators\":true}},\"footer\":{\"name\":\"b\",\"attribs\":{},\"children\":[\"Total: \",{\"name\":\"span\",\"attribs\":{},\"children\":[\"4840\"]}]},\"align\":\"right\"}],\"resizable\":true,\"pagination\":false,\"dataKey\":\"a64a65597d47a850c37f16e05c816396\"},\"children\":[]},\"class\":\"reactR_markup\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\nAo analisar os dados que relacionam as novas classificações da ANBIMA para fundos de Renda Fixa às quantidades de fundos em cada categoria, percebe-se novamente um predomínio significativo dos fundos classificados como **“Renda Fixa Duração Livre Crédito Livre”**, que totalizam 2.011 fundos. Em seguida, destacam-se os 909 fundos enquadrados em **“Renda Fixa Duração Livre Grau de Investimento”** e os 512 em **“Renda Fixa Duração Baixa Grau de Investimento”**.\n\nCategorias como **“Renda Fixa Duração Livre Soberano”** (341 fundos) e **“Renda Fixa Duração Baixa Soberano”** (259 fundos) possuem presença intermediária. Outras categorias, como **“Renda Fixa Indexados”** (194 fundos), **“Renda Fixa Simples”** (147 fundos) e **“Renda Fixa Investimento no Exterior”** (131 fundos), também apresentam relevância expressiva, assim como **“Renda Fixa Duração Média Grau de Investimento”** (117 fundos).\n\nPor outro lado, categorias como **“Renda Fixa Duração Alta Grau de Investimento”** (62 fundos), **“Renda Fixa Duração Baixa Crédito Livre”** (43 fundos), **“Renda Fixa Duração Média Crédito Livre”** (41 fundos), **“Renda Fixa Duração Alta Crédito Livre”** (33 fundos), **“Renda Fixa Duração Média Soberano”** (18 fundos), **“Renda Fixa Duração Alta Soberano”** (17 fundos) e **“Renda Fixa Dívida Externa”** (5 fundos) continuam sendo menos representativas.\n\nEssa distribuição evidencia uma preferência pelas categorias que oferecem maior flexibilidade na gestão dos recursos e exposição ao crédito privado ou grau de investimento. Em contraste, estratégias específicas ou nichos, como fundos de dívida externa ou soberanos com maior duração, reúnem poucos produtos, demonstrando que gestores e investidores optam predominantemente por categorias mais flexíveis e diversificadas em termos de risco e alocação.\n\n\n## Extrato de Infomações\n\nNeste estudo, eu utilizo como referência o arquivo disponibilizado pela ANBIMA, que traz informações qualitativas relevantes dos fundos de investimento. A base escolhida é o arquivo **<a href=\"https://dados.cvm.gov.br/dataset/fi-doc-extrato\" target=\"_blank\">Extrato de Informações</a>**, contendo diversas informações qualitativas sobre os fundos de investimento. Trata-se de uma base extensa com 117 colunas, da qual utilizei apenas as informações consideradas mais relevantes para este estudo.\n\nRecomendo ao leitor interessado acessar diretamente o arquivo completo caso deseje explorar detalhadamente todas as informações disponíveis.\n\n\nVamos baixar os dados da CVM diretamente em nosso script, porém não utilizaremos todas as 117 colunas disponíveis. Com base na documentação das variáveis disponibilizada pela Comissão de Valores Mobiliários (CVM) no link **<a href=\"https://dados.cvm.gov.br/dados/FI/DOC/EXTRATO/META/meta_extrato_fi.txt\" target=\"_blank\">Documentação das Variáveis do Extrato de Informações</a>**, faremos uma seleção das variáveis consideradas mais relevantes para a análise desenvolvida neste estudo:\n\n\n- **PUBLICO_ALVO:** público a que se destina o fundo de investimento.\n- **DISTRIB:** forma principal de distribuição do fundo.\n- **POLIT_INVEST:** política de investimento adotada.\n- **FUNDO_COTAS:** indicação se o fundo investe predominantemente em cotas de outros fundos.\n- **FUNDO_ESPELHO:** indicação se o fundo replica a carteira de outro fundo (fundo espelho).\n- **APLIC_MIN:** valor mínimo exigido para investimento inicial no fundo.\n- **ATUALIZ_DIARIA_COTA:** frequência da atualização e divulgação da cota do fundo.\n- **TAXA_SAIDA_PAGTO_RESGATE:** prazo efetivo para pagamento do resgate a partir da data de pedido.\n- **TAXA_ADM:** percentual cobrado como taxa de administração.\n- **EXISTE_TAXA_PERFM:** indicação da existência de taxa de performance.\n- **TAXA_PERFM:** valor percentual cobrado como taxa de performance.\n- **PARAM_TAXA_PERFM:** parâmetro utilizado para cobrança da taxa de performance.\n- **CALC_TAXA_PERFM:** método utilizado para calcular a taxa de performance.\n- **EXISTE_TAXA_INGRESSO:** indicação da existência de taxa de ingresso.\n- **EXISTE_TAXA_SAIDA:** indicação da existência de taxa de saída.\n- **INVEST_EXTERIOR:** indicação se o fundo realiza investimentos no exterior.\n- **ATIVO_CRED_PRIV:** indicação se o fundo investe em ativos de crédito privado.\n\nCreio que com essas variáveis vamos conseguir ter um bom raio x dos fundos de renda fixa.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nextrato_fi <- readr::read_delim(\"./extrato_fi.csv\", \n                                delim = \";\", \n                                escape_double = FALSE, \n                                locale = readr::locale(encoding = \"WINDOWS-1252\"), \n                                trim_ws = TRUE,\n                                quote = \"\") %>% \n  mutate(CNPJ_FUNDO_CLASSE = stringr::str_remove_all(CNPJ_FUNDO_CLASSE,\"\\\\.|/|-\")) \n```\n:::\n\n\n\nApós baixar os dados, vamos unir com nossa base de fundos para que possamos ver qualitativamente os fundos de renda fixa.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfundos_rf %>% \n  left_join(\n    extrato_fi %>% \n      select(CNPJ_FUNDO_CLASSE,PUBLICO_ALVO, DISTRIB, POLIT_INVEST, \n         FUNDO_COTAS,FUNDO_ESPELHO, APLIC_MIN, ATUALIZ_DIARIA_COTA,\n         TAXA_SAIDA_PAGTO_RESGATE, TAXA_ADM, EXISTE_TAXA_PERFM,\n         TAXA_PERFM, PARAM_TAXA_PERFM, CALC_TAXA_PERFM,\n         EXISTE_TAXA_INGRESSO, EXISTE_TAXA_SAIDA,\n         INVEST_EXTERIOR, ATIVO_CRED_PRIV),\n    by = c(\"CNPJ_FUNDO\" = \"CNPJ_FUNDO_CLASSE\") \n  ) -> fundos_rf\n```\n:::\n\n\n\nNo geral a explicação dada anteriomente já permite uma interpretação direta do tipo informacional que ela busca trnasmitir, proém, creio que as políticas de investimentos vales um detalhamento maior pois sua interpretação não ´pe tão direta. O documento publicado pela Comissão de Valores Mobiliários (CVM), disponível no link <a href=\"https://www.gov.br/cvm/pt-br/centrais-de-conteudo/publicacoes/estudos/arr-regime-informacional-fundos-555.pdf\" target=\"_blank\">Resumo CVM instrução CVM 175</a>, apresenta informações essenciais sobre o regime informacional aplicável aos fundos de investimento regulamentados pela Instrução CVM nº 555. Entre os tópicos abordados no estudo estão as principais políticas de investimento adotadas pelos fundos, que são resumidas a seguir:\n\n**Tipos de Políticas de Investimento**\n\n1. **Ativa e Referenciada:**  \nFundos que adotam gestão ativa, com o objetivo de obter retornos superiores a um índice de referência específico (benchmark). Embora busquem superá-lo, a estratégia permanece atrelada ao índice escolhido.\n\n2. **Ativa e Não Referenciada:**  \nFundos com gestão ativa, sem utilizar um índice específico como parâmetro para os resultados. A seleção dos investimentos é livre, não sendo direcionada à replicação ou superação de benchmarks definidos.\n\n3. **Passiva:**  \nFundos que utilizam gestão passiva, com o objetivo de acompanhar a variação de um índice de referência. Não possuem a intenção explícita de superar esse índice, replicando geralmente a sua composição.\n\n4. **Enhanced:**  \nFundos que integram estratégias ativas e passivas, buscando retornos acima do índice de referência, porém mantendo características semelhantes ao índice replicado, especialmente no que diz respeito ao perfil de risco e composição da carteira.\n\nCom essas informações em mãos, podemos agora analisar de forma quatitativa o perfil desses fundos de investimentos. O primeiro ponto que quero abordar consiste na distribuição entre público alvo e politicas de investimentos. Isso nos permitirá enxergar melhor se há uma tendência de política de investimentos a depender do público alvo deste fundo. O código a seguir vai slecionar somente as colunas de interesse. Como nossa base é grande, principalemtne devido as informações diárias que temos dos fundos de investimentos, temos que selecionar as colunas de nosso interesse e dessa forma obter somente os valores únicos para cada fundos de investimentos.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfundos_rf %>% \n  distinct(CNPJ_FUNDO,`Tipo de Investidor`,`Característica do Investidor`) %>% \n  count(`Tipo de Investidor`,`Característica do Investidor`) %>% \n  arrange(-n) %>% \n  rename(Quantidade = n) %>% \n  reactable::reactable(\n    pagination = FALSE,  # Desativa a paginação da tabela\n    resizable = TRUE,  # Permite redimensionamento das colunas\n    columns = list(\n      Quantidade = colDef(\n        align = \"right\",  # Alinha os valores numéricos à direita\n        format = colFormat(separators = TRUE),  # Formata os números com separadores de milhar\n        footer = function(values) {  # Adiciona um rodapé à coluna Quantidade\n          tags$b(\"Total: \") %>%  # Coloca a palavra \"Total\" em negrito\n            tagAppendChildren(tags$span(sum(values)))  # Adiciona a soma total ao lado\n        }\n      )\n    )\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"reactable html-widget html-fill-item\" id=\"htmlwidget-a01e5a6748a2b40dafbf\" style=\"width:auto;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-a01e5a6748a2b40dafbf\">{\"x\":{\"tag\":{\"name\":\"Reactable\",\"attribs\":{\"data\":{\"Tipo de Investidor\":[\"Não Há Restrição\",\"Exclusivo\",\"Reservado\",\"Não Há Restrição\",\"Não Há Restrição\",\"Não há Restrição\",\"Reservado\",\"Não há Restrição\",\"Reservado\",\"Exclusivo\",\"Não há Restrição\",\"Exclusivo\",\"Não há Restrição\",null],\"Característica do Investidor\":[\"Geral\",\"Profissional\",\"Profissional\",\"Qualificado\",\"Profissional\",\"Geral\",\"Qualificado\",\"Profissional\",\"Geral\",\"Qualificado\",\"Qualificado\",\"Geral\",null,null],\"Quantidade\":[2002,1110,570,410,288,135,110,73,47,42,38,14,1,1]},\"columns\":[{\"id\":\"Tipo de Investidor\",\"name\":\"Tipo de Investidor\",\"type\":\"character\"},{\"id\":\"Característica do Investidor\",\"name\":\"Característica do Investidor\",\"type\":\"character\"},{\"id\":\"Quantidade\",\"name\":\"Quantidade\",\"type\":\"numeric\",\"format\":{\"cell\":{\"separators\":true},\"aggregated\":{\"separators\":true}},\"footer\":{\"name\":\"b\",\"attribs\":{},\"children\":[\"Total: \",{\"name\":\"span\",\"attribs\":{},\"children\":[\"4841\"]}]},\"align\":\"right\"}],\"resizable\":true,\"pagination\":false,\"dataKey\":\"e629dbdb1d0b6fa7710cf51c9037274f\"},\"children\":[]},\"class\":\"reactR_markup\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\nA análise da tabela que apresenta o **Tipo e a Característica do Investidor** em relação às quantidades de fundos revela uma forte concentração dos fundos abertos ao público geral, especialmente na combinação **\"Não Há Restrição - Geral\"**, que conta com um total de **2.137 fundos** (2.002 + 135). Outra parcela significativa é formada pelos fundos destinados ao investidor profissional, com destaque para as categorias **\"Exclusivo - Profissional\"** com **1.110 fundos** e **\"Reservado - Profissional\"**, que possui **570 fundos**.\n\nDestaca-se também o número expressivo de fundos destinados a investidores qualificados na categoria **\"Não Há Restrição - Qualificado\"**, que soma **410 fundos**, além dos fundos reservados e exclusivos para investidores profissionais (**Reservado - Profissional** com **570 fundos** e **Exclusivo - Profissional** com **1.110 fundos**). Esses fundos reservados e exclusivos indicam uma segmentação clara para investidores que possuem maior conhecimento sobre o mercado financeiro e potencialmente maior capital disponível.\n\nPor outro lado, fundos voltados especificamente para investidores qualificados nas modalidades reservada (**Reservado - Qualificado**) e exclusiva (**Exclusivo - Qualificado**) possuem representação relativamente baixa, com **110** e **42 fundos**, respectivamente. Também aparece com pouca representatividade a combinação **\"Reservado - Geral\"**, com apenas **14 fundos**.\n\nDe maneira geral, os dados evidenciam que os fundos sem restrição de acesso são predominantes, principalmente aqueles voltados ao público geral e profissional, mostrando um mercado bastante aberto, mas também segmentado em nichos específicos, como os fundos exclusivos e reservados a investidores profissionais. Isso sugere que os gestores buscam atender diferentes perfis de investidores com estratégias direcionadas ao nível de sofisticação e exigências específicas.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nextrato_fi %>% \n  distinct(DT_COMPTC, CNPJ_FUNDO_CLASSE, POLIT_INVEST, FUNDO_ESPELHO, FUNDO_COTAS) %>%\n  filter(CNPJ_FUNDO_CLASSE %in% distinct(fundos_rf, CNPJ_FUNDO)$CNPJ_FUNDO) %>% \n  mutate(DT_COMPTC = as.Date(DT_COMPTC)) %>%  # Converte a data para o formato adequado\n  arrange(DT_COMPTC) %>%  # Ordena as datas de competência\n  group_by(CNPJ_FUNDO_CLASSE) %>% \n  summarise_all(last) %>%  # Mantém apenas a última entrada por fundo\n  ungroup() %>% \n  mutate(\n    FUNDO_ESPELHO = case_when(\n      is.na(FUNDO_ESPELHO) ~ \"Não\",\n      FUNDO_ESPELHO == \"N\" ~ \"Não\",\n      .default = \"Sim\"\n    ),\n    FUNDO_COTAS = case_when(\n      FUNDO_COTAS == \"N\" ~ \"Não\",\n      .default = \"Sim\"\n    )\n  ) %>% \n  count(POLIT_INVEST, FUNDO_ESPELHO, FUNDO_COTAS) %>% \n  rename(\n    `Política de Investimento` = POLIT_INVEST,\n    `Fundo Espelho` = FUNDO_ESPELHO,\n    `Fundo de Cotas` = FUNDO_COTAS,\n    Quantidade = n\n  ) %>%\n  reactable(\n    pagination = FALSE,  # Desativa a paginação\n    defaultColDef = colDef(minWidth = 150),  # Define uma largura mínima para as colunas\n    resizable = TRUE,  # Permite redimensionamento das colunas\n    columns = list(\n      `Política de Investimento` = colDef(width = 250),  # Define largura da coluna\n      `Fundo Espelho` = colDef(width = 150),  # Define largura da coluna\n      `Fundo de Cotas` = colDef(width = 150),  # Define largura da coluna\n      Quantidade = colDef(\n        align = \"right\",  # Alinha os valores numéricos à direita\n        format = colFormat(separators = TRUE),  # Formata os números com separadores de milhar\n        footer = function(values) {  # Adiciona um rodapé à coluna Quantidade\n          tags$b(\"Total: \") %>%  # Deixa a palavra \"Total\" em negrito\n            tagAppendChildren(tags$span(sum(values)))  # Exibe a soma total ao lado\n        }\n      )\n    )\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"reactable html-widget html-fill-item\" id=\"htmlwidget-caa0d2a6ee4e0362722d\" style=\"width:auto;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-caa0d2a6ee4e0362722d\">{\"x\":{\"tag\":{\"name\":\"Reactable\",\"attribs\":{\"data\":{\"Política de Investimento\":[\"ATIVA E NÃO-REFERENCIADA\",\"ATIVA E NÃO-REFERENCIADA\",\"ATIVA E NÃO-REFERENCIADA\",\"ATIVA E REFERENCIADA\",\"ATIVA E REFERENCIADA\",\"ATIVA E REFERENCIADA\",\"ENHANCED\",\"ENHANCED\",\"ENHANCED\",\"PASSIVA\",\"PASSIVA\",\"PASSIVA\"],\"Fundo Espelho\":[\"Não\",\"Não\",\"Sim\",\"Não\",\"Não\",\"Sim\",\"Não\",\"Não\",\"Sim\",\"Não\",\"Não\",\"Sim\"],\"Fundo de Cotas\":[\"Não\",\"Sim\",\"Sim\",\"Não\",\"Sim\",\"Sim\",\"Não\",\"Sim\",\"Sim\",\"Não\",\"Sim\",\"Sim\"],\"Quantidade\":[1522,577,81,881,246,44,25,11,1,333,358,16]},\"columns\":[{\"id\":\"Política de Investimento\",\"name\":\"Política de Investimento\",\"type\":\"character\",\"minWidth\":150,\"width\":250},{\"id\":\"Fundo Espelho\",\"name\":\"Fundo Espelho\",\"type\":\"character\",\"minWidth\":150,\"width\":150},{\"id\":\"Fundo de Cotas\",\"name\":\"Fundo de Cotas\",\"type\":\"character\",\"minWidth\":150,\"width\":150},{\"id\":\"Quantidade\",\"name\":\"Quantidade\",\"type\":\"numeric\",\"minWidth\":150,\"format\":{\"cell\":{\"separators\":true},\"aggregated\":{\"separators\":true}},\"footer\":{\"name\":\"b\",\"attribs\":{},\"children\":[\"Total: \",{\"name\":\"span\",\"attribs\":{},\"children\":[\"4095\"]}]},\"align\":\"right\"}],\"resizable\":true,\"pagination\":false,\"dataKey\":\"d64c1ae264610f02bad18bcf9619f92f\"},\"children\":[]},\"class\":\"reactR_markup\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\nA análise da tabela que relaciona a Política de Investimento dos fundos, juntamente com as características Fundo Espelho e Fundo de Cotas, mostra claramente uma concentração predominante nos fundos com gestão \"Ativa e Não-Referenciada\", especialmente aqueles que não são fundos espelho nem fundos de cotas, com um total expressivo de 1.522 fundos. A seguir, destacam-se fundos com a mesma política de gestão, mas que são fundos de cotas (577 fundos).\n\nOutro grupo com alta representatividade são os fundos com política de investimento “Ativa e Referenciada”, principalmente aqueles que não são fundos espelho nem de cotas (881 fundos), seguidos por aqueles que são fundos de cotas (246 fundos). Ainda nessa política de gestão, há uma menor presença dos fundos que são ao mesmo tempo fundos espelho e fundos de cotas, com apenas 44 fundos.\n\nEntre os fundos com política “Passiva”, percebe-se uma divisão mais equilibrada entre aqueles que são fundos de cotas (358 fundos) e os que não são (333 fundos). Já na categoria “Enhanced”, há uma participação bastante reduzida, sendo apenas 25 fundos não espelho e não fundos de cotas, 11 fundos que são apenas fundos de cotas, e apenas 1 fundo que combina ambas características.\n\nNo geral, fica clara a preferência dos gestores e investidores pela política de gestão ativa, sobretudo não-referenciada, enquanto estratégias mais específicas e menos convencionais, como a gestão “Enhanced” ou fundos espelho com cotas, mantêm representatividade bastante limitada. Esses dados indicam que o mercado brasileiro de fundos ainda prioriza estratégias tradicionais e ativas de investimento.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nextrato_fi %>% \n  filter(CNPJ_FUNDO_CLASSE %in% distinct(fundos_rf, CNPJ_FUNDO)$CNPJ_FUNDO) %>%\n  distinct(DT_COMPTC, \n           CNPJ_FUNDO_CLASSE, \n           POLIT_INVEST, \n           EXISTE_TAXA_INGRESSO, \n           EXISTE_TAXA_PERFM, \n           EXISTE_TAXA_SAIDA) %>% \n  count(POLIT_INVEST, \n        EXISTE_TAXA_INGRESSO, \n        EXISTE_TAXA_PERFM, \n        EXISTE_TAXA_SAIDA) %>%\n  mutate(\n    EXISTE_TAXA_INGRESSO = case_match(\n      EXISTE_TAXA_INGRESSO, \n      \"S\" ~ \"Sim\", \n      \"N\" ~ \"Não\", \n      .default = EXISTE_TAXA_INGRESSO),\n    EXISTE_TAXA_PERFM = case_match(\n      EXISTE_TAXA_PERFM, \n      \"S\" ~ \"Sim\", \n      \"N\" ~ \"Não\", \n      .default = EXISTE_TAXA_PERFM),\n    EXISTE_TAXA_SAIDA = case_match(\n      EXISTE_TAXA_SAIDA, \n      \"S\" ~ \"Sim\", \n      \"N\" ~ \"Não\", \n      .default = EXISTE_TAXA_SAIDA)\n  ) %>% \n  rename(\n    `Política de Investimento` = POLIT_INVEST,\n    `Taxa de Ingresso` = EXISTE_TAXA_INGRESSO,\n    `Taxa de Performance` = EXISTE_TAXA_PERFM,\n    `Taxa de Saída` = EXISTE_TAXA_SAIDA,\n    Quantidade = n\n  ) %>%\n  reactable(\n    pagination = FALSE,  # Desativa a paginação\n    resizable = TRUE,  # Permite redimensionamento das colunas\n    columns = list(\n      `Política de Investimento` = colDef(width = 300),  # Define largura da coluna\n      `Taxa de Ingresso` = colDef(width = 120),  # Define largura da coluna\n      `Taxa de Performance` = colDef(width = 120),  # Define largura da coluna\n      `Taxa de Saída` = colDef(width = 120),  # Define largura da coluna\n      Quantidade = colDef(\n        align = \"right\",  # Alinha os valores numéricos à direita\n        format = colFormat(separators = TRUE),  # Formata os números com separadores de milhar\n        footer = function(values) {  # Adiciona um rodapé à coluna Quantidade\n          tags$b(\"Total: \") %>%  # Deixa a palavra \"Total\" em negrito\n            tagAppendChildren(tags$span(sum(values)))  # Exibe a soma total ao lado\n        }\n      )\n    )\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"reactable html-widget html-fill-item\" id=\"htmlwidget-b06f25ae7b8fbed5a13e\" style=\"width:auto;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-b06f25ae7b8fbed5a13e\">{\"x\":{\"tag\":{\"name\":\"Reactable\",\"attribs\":{\"data\":{\"Política de Investimento\":[\"ATIVA E NÃO-REFERENCIADA\",\"ATIVA E NÃO-REFERENCIADA\",\"ATIVA E NÃO-REFERENCIADA\",\"ATIVA E NÃO-REFERENCIADA\",\"ATIVA E REFERENCIADA\",\"ATIVA E REFERENCIADA\",\"ATIVA E REFERENCIADA\",\"ATIVA E REFERENCIADA\",\"ENHANCED\",\"ENHANCED\",\"PASSIVA\",\"PASSIVA\",\"PASSIVA\",\"PASSIVA\"],\"Taxa de Ingresso\":[\"Não\",\"Não\",\"Não\",\"Não\",\"Não\",\"Não\",\"Não\",\"Não\",\"Não\",\"Não\",\"Não\",\"Não\",\"Não\",\"Não\"],\"Taxa de Performance\":[\"Não\",\"Não\",\"Sim\",\"Sim\",\"Não\",\"Não\",\"Sim\",\"Sim\",\"Não\",\"Sim\",\"Não\",\"Não\",\"Sim\",\"Sim\"],\"Taxa de Saída\":[\"Não\",\"Sim\",\"Não\",\"Sim\",\"Não\",\"Sim\",\"Não\",\"Sim\",\"Não\",\"Não\",\"Não\",\"Sim\",\"Não\",\"Sim\"],\"Quantidade\":[1757,12,407,4,803,2,362,4,35,2,669,4,32,2]},\"columns\":[{\"id\":\"Política de Investimento\",\"name\":\"Política de Investimento\",\"type\":\"character\",\"width\":300},{\"id\":\"Taxa de Ingresso\",\"name\":\"Taxa de Ingresso\",\"type\":\"character\",\"width\":120},{\"id\":\"Taxa de Performance\",\"name\":\"Taxa de Performance\",\"type\":\"character\",\"width\":120},{\"id\":\"Taxa de Saída\",\"name\":\"Taxa de Saída\",\"type\":\"character\",\"width\":120},{\"id\":\"Quantidade\",\"name\":\"Quantidade\",\"type\":\"numeric\",\"format\":{\"cell\":{\"separators\":true},\"aggregated\":{\"separators\":true}},\"footer\":{\"name\":\"b\",\"attribs\":{},\"children\":[\"Total: \",{\"name\":\"span\",\"attribs\":{},\"children\":[\"4095\"]}]},\"align\":\"right\"}],\"resizable\":true,\"pagination\":false,\"dataKey\":\"440824a8b82361af56ea8ff549b6c716\"},\"children\":[]},\"class\":\"reactR_markup\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\n\nA análise dos dados referentes às políticas de investimento e taxas associadas aos fundos revela uma expressiva predominância dos fundos com política de investimento **\"Ativa e Não-Referenciada\"** sem incidência de taxas, que totalizam **1.757 fundos**. Destacam-se também, nessa mesma categoria, os fundos que cobram taxa de performance (**407 fundos**). Contudo, a cobrança de taxa de saída permanece pouco utilizada nesses fundos, com apenas 12 casos sem taxa de performance e 4 fundos com ambas as taxas.\n\nA segunda categoria mais representativa é composta pelos fundos com política **\"Ativa e Referenciada\"**, com destaque para fundos que não cobram taxas adicionais (**803 fundos**). Já a aplicação de taxas extras é menos frequente nessa política, indicando que gestores desses fundos preferem estruturas de custo mais simples ou tradicionais.\n\nPor outro lado, os fundos de política **\"Passiva\"** aparecem em número intermediário, destacando-se aqueles que não têm taxas (**669 fundos**). A aplicação de taxa de performance também é pouco comum nessa categoria, contando com apenas **35 fundos**, enquanto a cobrança simultânea de taxa de performance e de saída ocorre em apenas 2 fundos.\n\nEsses resultados indicam claramente que os fundos ativos são predominantes no mercado, especialmente os não-referenciados, sugerindo uma maior preferência dos investidores por estratégias flexíveis. Além disso, fundos com menor cobrança de taxas (taxa de ingresso, performance ou saída) apresentam uma quantidade significativamente superior, apontando uma preferência por estruturas mais simples em termos de custos associados ao investimento.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfundos_rf %>%\n  filter(!is.na(POLIT_INVEST)) %>%\n  mutate(Competência = zoo::as.yearqtr(DT_COMPTC)) %>%\n  filter(Competência >= \"2010 Q1\") %>%\n  \n  # Divide por 1e9 para converter os valores em bilhões\n  summarise(\n    Captação = sum(CAPTC_DIA) / 1e9,\n    Resgates = -sum(RESG_DIA) / 1e9,\n    .by = c(\"Competência\", \"Categoria ANBIMA\")\n  ) %>%\n  \n  mutate(CAPTC_LIQ = Captação + Resgates) %>%\n  pivot_wider(\n    names_from = \"Categoria ANBIMA\",\n    values_from = \"CAPTC_LIQ\"\n  ) %>%\n  rename(`Captação líquida` = `Renda Fixa`) %>%\n  arrange(Competência) %>%\n  mutate(`Captação líquida acumulada` = cumsum(`Captação líquida`)) %>%\n  \n  ggplot(aes(x = Competência)) +\n  tema_g1() +\n  \n  geom_col(aes(y = Captação, fill = \"Captação\"), position = \"dodge\") +\n  geom_col(aes(y = Resgates, fill = \"Resgates\"), position = \"dodge\") +\n  geom_line(aes(y = `Captação líquida`, group = 1, color = \"Captação líquida\"), size = 1.2) +\n  geom_line(aes(y = `Captação líquida acumulada`, group = 1, color = \"Captação líquida acumulada\"), size = 1.2) +\n  \n  labs(\n    x = \"Competência\",\n    y = \"Valores (R$ bilhões)\",\n    title = \"Histórico de Captação\",\n    subtitle = \"Captação e Resgates com sua evolução trimestral desde o início de 2010\",\n    caption = \"Fonte: Dados da CVM - Elaboração Própria\",\n    fill = \"Legenda\",\n    color = \"Legenda\"\n  ) +\n  \n  # Use scale = 1 e divida os dados por 1e9 para que 1 = 1 bilhão\n  scale_y_continuous(\n    labels = label_number(\n      scale = 1,      # não redimensiona mais os dados\n      suffix = \" B\",  # exibe 'B' para bilhões\n      accuracy = 1    # ajusta se quiser mais ou menos casas decimais\n    )\n  ) +\n  \n  scale_fill_manual(values = c(\"Captação\" = \"steelblue\", \"Resgates\" = \"tomato\")) +\n  scale_color_manual(values = c(\"Captação líquida\" = \"darkgreen\", \"Captação líquida acumulada\" = \"purple\")) +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/core-js-2.5.3/shim.min.js\"></script>\n<script src=\"../../site_libs/react-18.2.0/react.min.js\"></script>\n<script src=\"../../site_libs/react-18.2.0/react-dom.min.js\"></script>\n<script src=\"../../site_libs/reactwidget-2.0.0/react-tools.umd.cjs\"></script>\n<link href=\"../../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<link href=\"../../site_libs/reactable-0.4.4/reactable.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/reactable-binding-0.4.4/reactable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}